<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Genomic prediction for metabolites in rice | Ye Bi 毕晔</title>
    <meta name="author" content="Ye  Bi" />
    <meta name="description" content="Role of genomics on regulating rice grain metabolic variability under warmer nights, A statistical and image-based deep learning approach" />
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website" />

    <!-- OpenGraph -->
    <meta property="og:site_name" content="Ye Bi 毕晔" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Ye Bi 毕晔 | Genomic prediction for metabolites in rice" />
    <meta property="og:url" content="http://localhost:4000/projects/8_project/" />
    <meta property="og:description" content="Role of genomics on regulating rice grain metabolic variability under warmer nights, A statistical and image-based deep learning approach" />
    
    <meta property="og:locale" content="en" />

    <!-- Twitter card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Genomic prediction for metabolites in rice" />
    <meta name="twitter:description" content="Role of genomics on regulating rice grain metabolic variability under warmer nights, A statistical and image-based deep learning approach" />
    
    <meta name="twitter:site" content="@YeBi000" />
    <meta name="twitter:creator" content="@YeBi000" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>☺︎</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="http://localhost:4000/projects/8_project/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark" />

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/">Ye Bi 毕晔</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">About Me</a>
              </li>
              

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">Projects</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/cv/">CV</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">Publications</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/repositories/">Github</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/news/">News</a>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="container mt-5">
      <!-- page.html -->
        <div class="post">

          <header class="post-header">
            <h1 class="post-title">Genomic prediction for metabolites in rice</h1>
            <p class="post-description">Role of genomics on regulating rice grain metabolic variability under warmer nights, A statistical and image-based deep learning approach</p>
          </header>

          <article>
            <p>Preprint: <a href="https://github.com/yebigithub/GBLUP4Met/tree/main?tab=readme-ov-file" target="_blank" rel="noopener noreferrer">link</a></p>

<h2 id="abstract">Abstract</h2>
<p>It has been argued that metabolites can be used to accelerate crop improvement because metabolic profiles in crops are generally under genetic control. Evaluating the role of genetics in metabolic variation is a longstanding challenge. Rice, one of the world’s most important staple crops, is known to be sensitive to recent increases in nighttime temperatures. Quantification of metabolic levels can help measure rice responses to high nighttime temperature (HNT) stress. However, the extent of metabolic variation that can be explained by regression on whole-genome molecular markers remains to be answered. In the current study, primary metabolites of a rice diversity panel generated from grains using gas chromatography-mass spectrometry were used. The metabolites obtained were low to moderately heritable, and the genomic prediction accuracies of the metabolites were within the expected upper limit set by their genomic heritability estimates. Genomic heritability estimates were slightly higher in the control group than in the HNT group. Genomic correlation estimates for the same metabolites between the control and HNT conditions indicated the presence of genotype by environment interactions. Reproducing kernel Hilbert spaces regression and deep learning, which treat markers as images, improved prediction accuracy, suggesting that some metabolites are under non-additive genetic control. Joint analysis of multiple metabolites simultaneously was effective in improving prediction accuracy by exploiting correlations among metabolites. The current study serves as an important first step in evaluating the cumulative effects of the genome in regulating metabolic variation under control and HNT conditions.</p>

<h2 id="0-data-preprocessing">0. Data Preprocessing</h2>
<ul>
  <li>
<a href="https://github.com/yebigithub/GBLUP4Met/blob/main/PreProcessing/DataPreprocessing.Rmd" target="_blank" rel="noopener noreferrer">.Rmd file</a> Including metabolite and genotype data cleaning</li>
</ul>

<h2 id="1-genomic-heritability-of-metabolites">1. Genomic heritability of metabolites</h2>
<ul>
  <li>
<a href="https://github.com/yebigithub/GBLUP4Met/blob/main/heritability/h2_calculate.R" target="_blank" rel="noopener noreferrer">.R file</a> Using sommer package to calculate heritability for metabolites.</li>
  <li>
<a href="https://github.com/yebigithub/GBLUP4Met/blob/main/heritability/h2_plot_drawing.Rmd" target="_blank" rel="noopener noreferrer">.Rmd file</a> Drawing heritability plots.</li>
</ul>

<p align="center">
  <img src="https://github.com/yebigithub/GBLUP4Met/blob/main/heritability/Figure2.png" width="70%" height="70%" alt="">
</p>
<p>Figure 2: Genomic heritability estimates of metabolite accumulation in control and high night temperature stress conditions. A) Scatter plot. B) Density plot. Solid and dashed lines indicate mean and median, respectively. C) Agreement of heritability estimates between control and high night temperature stress conditions. Metabolites in green and red colors indicate that the heritability difference between control and high night temperature stress conditions was small (&lt; 0.05) and large (&gt; 0.1)</p>

<h2 id="2-single-trait-genomic-prediction-of-metabolites">2. Single-trait genomic prediction of metabolites</h2>
<ul>
  <li>
<a href="https://github.com/yebigithub/GBLUP4Met/blob/main/SingleTraitGBLUP/GBLUP_whole.R" target="_blank" rel="noopener noreferrer">.R file</a> Running Single trait GBLUP in cluster.</li>
  <li>
<a href="https://github.com/yebigithub/GBLUP4Met/blob/main/SingleTraitGBLUP/SingleTraitGBLUP.Rmd" target="_blank" rel="noopener noreferrer">.Rmd file</a> Drawing Single trait GBLUP plots.</li>
  <li>
<a href="https://github.com/yebigithub/GBLUP4Met/blob/main/SingleTraitGBLUP/GK.Rmd" target="_blank" rel="noopener noreferrer">.Rmd file</a> Selecting suitable bandwidth for RKHS.</li>
  <li>
<a href="https://github.com/yebigithub/GBLUP4Met/blob/main/SingleTraitGBLUP/GK.R" target="_blank" rel="noopener noreferrer">.R file</a> Runing Single trait RKHS in cluster.</li>
</ul>

<p align="center">
  <img src="https://github.com/yebigithub/GBLUP4Met/blob/main/SingleTraitGBLUP/Figure4.png" width="70%" height="70%" alt="">
</p>
<p>Figure 4: Genomic prediction accuracy of metabolite accumulation in control and high night
temperature stress conditions. A) Box plot. The horizontal line indicates the mean value.
B) Density plot. The solid and dashed lines indicate the mean and median, respectively.
C) Agreement of genomic prediction accuracy between control and high night temperature
stress conditions. Metabolite accumulations in green and red colors indicate that the genomic
prediction difference between control and high night temperature stress conditions was small
(&lt; 0.05) and large (&gt; 0.1).</p>

<h2 id="3-genomic-correlation-between-the-same-metabolite-in-different-treatments">3. Genomic correlation between the same metabolite in different treatments</h2>
<ul>
  <li>
<a href="./GenoCorrSameMet/GenoCorrSameMet.R">.R file</a> Running multi-trait genomic correlation.</li>
  <li>
<a href="./GenoCorrSameMet/GenoCorrSameMet.Rmd">.Rmd file</a> Drawing multi-trait genomic correlation plots.</li>
</ul>

<p align="center">
  <img src="https://github.com/yebigithub/GBLUP4Met/blob/main/GenoCorrSameMet/Figure3.png" width="70%" height="70%" alt="">
</p>
<p>Figure 3: Genomic correlation estimates between the same metabolite accumulation measured under control and high night temperature stress conditions.  A) Scatter plot. B) Bar chart. Solid and dashed lines indicate mean and median, respectively.</p>

<h2 id="4-exporatory-factor-analysis">4. Exporatory factor analysis</h2>
<ul>
  <li>
<a href="./FactorAnalysis/FA4Met.Rmd">.Rmd file</a> Factorial analysis to identify underlying latent factors controlling metabolites.</li>
</ul>

<h2 id="5-simultaneous-regression-modeling-of-metabolites">5. Simultaneous regression modeling of metabolites</h2>
<ul>
  <li>
<a href="./SimultaneousRegression/MegaLLM.R">.R file</a> Running MegaLMM for genomic prediction.</li>
  <li>
<a href="./SimultaneousRegression/MegaLLM_GK.R">.R file</a> Running MegaLMM for RKHS.</li>
  <li>
<a href="./SimultaneousRegression/MegaLMM_drawing.Rmd">.Rmd file</a> Drawing barplot, density plots for MegaLMM genomic prediction model.</li>
  <li>
<a href="./SimultaneousRegression/GenomicCorr.Rmd">.Rmd file</a> Drawing genomic correlation density plot.</li>
</ul>

<p align="center">
  <img src="https://github.com/yebigithub/GBLUP4Met/blob/main/SimultaneousRegression/ggcorr_MegaLMM_density_-1.png" width="70%" height="70%" alt="">
</p>
<p>Figure 7: Genomic correlation estimates between different metabolite accumulation in control and high night temperature stress conditions. The solid and dashed lines indicate mean and median, respectively.
<br><br></p>

<p align="center">
  <img src="https://github.com/yebigithub/GBLUP4Met/blob/main/SimultaneousRegression/G_GK_Mega-1.png" width="70%" height="70%" alt="">
</p>
<p>Figure 8: Percentage difference of gain in prediction accuracy for multi-trait genomic best linear unbiased prediction (MegaLMM-G) and multi-trait reproducing kernel Hilbert spaces regression (MegaLMM-GK) relative to single-trait genomic best linear unbiased prediction (A). Density plots of percentage difference are shown for MegaLMM-G (B) and MegaLMM-GK (C).</p>

<h2 id="6-deep-learning-models">6. Deep learning models</h2>
<ul>
  <li>
<a href="./DL/ConvertSNP2Image.ipynb">.ipynb</a> Shows examples about how to convert SNP tabular data into SNP images.</li>
  <li>
<a href="./DL/ConvertSNP2Image.py">.py file</a> Loop converting for SNPs in all chromosomes.</li>
  <li>
<a href="./DL/FeatureExtractorMulti.py">.py file</a> Convolutional neural network with multiple branches.</li>
  <li>
<a href="./DL/DL_drawing.Rmd">.Rmd file</a> Drawing barplot to compare performance of all deep learning models and RKHS.</li>
</ul>

<p align="center">
  <img src="./DL/workflow4DL-1.png" width="80%" height="80%" alt="">
</p>
<p>Figure1: Flowchart of converting single nucleotide polymorphisms to image data</p>

<p><br><br></p>
<p align="center">
  <img src="https://github.com/yebigithub/GBLUP4Met/blob/main/DL/SNPimagesExample-1.png" width="70%" height="60%" alt="">
</p>
<p>Figure 6: Example of a set of single nucleotide polymorphisms transformed into image data for a randomly selected genotype. Images of 12 chromosomes were processed in the multi-channel convolutional neural networks</p>

<p><br><br></p>
<p align="center">
  <img src="https://github.com/yebigithub/GBLUP4Met/blob/main/DL/DL_dff_barplot_0.1_positive-1.png" width="70%" height="70%" alt="">
</p>
<p>Figure 5: Percentage difference of gain in prediction accuracy for single-trait reproducing kernel Hilbert spaces regression (RKHS), VGG16, ResNet50 EfficientNetB7, InceptionV3, MobileNetV2, and DenseNet201 relative to single-trait genomic best linear unbiased prediction.</p>

<h2 id="7-supplementary">7. Supplementary</h2>
<ul>
  <li>
<a href="./Supplementary/PhenoCorr.Rmd">.Rmd file</a> Calculating phenotypical correaliton between metabolites in control and stress conditions.</li>
  <li>
<a href="./SimultaneousRegression/MegaLMM_ggcorr.R">.Rmd file</a> Drawing MegaLMM genomic correlation heatmaps.</li>
  <li>
<a href="./FactorAnalysis/FA4Met.Rmd">.Rmd file</a> Drawing factorial analysis heatmaps.</li>
  <li>
<a href="./Supplementary/FA_drawing.Rmd">.Rmd file</a> Drawing factorial analysis density plots.</li>
</ul>

          </article>

        </div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2024 Ye  Bi. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script defer src="/assets/js/common.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
  </body>
</html>
