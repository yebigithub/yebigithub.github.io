I"–#<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/DairyBW/bw-480.webp" />
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/DairyBW/bw-800.webp" />
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/DairyBW/bw-1400.webp" />
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/DairyBW/bw.png" class="img-fluid rounded z-depth-0" width="auto" height="auto" title="title" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" />

  </picture>

</figure>

    </div>
</div>

<p>Paper: <a href="https://doi.org/10.1016/j.atech.2023.100352">https://doi.org/10.1016/j.atech.2023.100352</a><br />
Codes: <a href="https://github.com/yebigithub/BW_dairy">https://github.com/yebigithub/BW_dairy</a></p>

<p><strong>Abstract</strong><br />
Monitoring cow body weight is crucial to support farm management decisions due to its direct relationship with the growth, nutritional status, and health of dairy cows. Cow body weight is a repeated trait, however, the majority of previous body weight prediction research only used data collected at a single point in time. Furthermore, the utility of deep learning-based segmentation for body weight prediction using videos remains unanswered. Therefore, the objectives of this study were to predict cow body weight from repeatedly measured video data, to compare the performance of the thresholding and Mask R-CNN deep learning approaches, to evaluate the predictive ability of body weight regression models, and to promote open science in the animal science community by releasing the source code for video-based body weight prediction. An Intel RealSense D435 camera was installed on Virginia Tech dairy complex to collect top-view videos of 10 lactating Holstein cows twice a day for 28 days after milking sessions and 2 non-lactating, pregnant Jersey cows once a week upon calving. At the same time, the ground truth body weight records were collected using a walk-over weighing system. A total of 40,405 depth images and depth map files were obtained. Three approaches were investigated to segment the cowâ€™s body from the background, including single thresholding, adaptive thresholding, and Mask R-CNN. Four image-derived biometric features, such as dorsal length, abdominal width, height, and volume, were estimated from the segmented images and fitted using ordinary least squares, ridge regression, least absolute shrinkage and selection operator, and linear mixed models. Two cross-validation designs, forecasting and leave-three-cows-out, were used to evaluate prediction performance. The Pearson correlation between image-derived biometric features and scale-based body weight ranged from 0.74 to 0.95. On average, the Mask-RCNN approach combined with a linear mixed model resulted in the best prediction coefficient of determination and mean absolute percentage error of 0.98 and 2.03%, respectively, in the forecasting cross-validation. The Mask-RCNN approach was also the best in the leave-three-cows-out cross-validation, followed by adaptive and single thresholding. The prediction coefficients of determination and mean absolute percentage error of the Mask-RCNN coupled with the linear mixed model were 0.90 and 4.70%, respectively. Our results suggest that deep learning-based segmentation improves the prediction performance of cow body weight from longitudinal depth video data.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <img src="/assets/img/DairyBW/Fig.1.png" style="float: center; width: 70%; height: 70%;" />
    </div>

</div>
<div class="caption">
Fig. 1.: Image conversion process. A) The original depth image. B) Cropped depth image. C) The RGB color model was converted to the HSV color model. D) Hue was extracted and used for subsequent analyses.
</div>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/DairyBW/Fig.2-480.webp" />
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/DairyBW/Fig.2-800.webp" />
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/DairyBW/Fig.2-1400.webp" />
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/DairyBW/Fig.2.png" class="img-fluid rounded z-depth-0" width="auto" height="auto" title="cv1" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" />

  </picture>

</figure>

    </div>

</div>
<div class="caption">
Fig. 2. Neck removal process. A) Binary image after thresholding. B) The initial segmentation that includes the neck. C) The ratio of body width was used to remove the neck. Blue line represents the column location that returns the maximum number of white pixels across all columns. Red line represents the column location that provides the ratio of 0.3 relative to the blue line. D) The final cow body area with the bounding box. The cyan box, yellow line, and blue line denote the bounding box, dorsal length, and abdomen width, respectively.
</div>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/DairyBW/Fig.4-480.webp" />
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/DairyBW/Fig.4-800.webp" />
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/DairyBW/Fig.4-1400.webp" />
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/DairyBW/Fig.4.png" class="img-fluid rounded z-depth-0" width="auto" height="auto" title="cv1" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" />

  </picture>

</figure>

    </div>

</div>
<div class="caption">
Fig. 4. Overview of the biometric approach using thresholding.
</div>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/DairyBW/Fig.5-480.webp" />
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/DairyBW/Fig.5-800.webp" />
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/DairyBW/Fig.5-1400.webp" />
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/DairyBW/Fig.5.png" class="img-fluid rounded z-depth-0" width="auto" height="auto" title="cv1" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" />

  </picture>

</figure>

    </div>

</div>
<div class="caption">
Fig. 5. Overview of the biometric approach using Mask R-CNN.
</div>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/DairyBW/Fig.7-480.webp" />
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/DairyBW/Fig.7-800.webp" />
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/DairyBW/Fig.7-1400.webp" />
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/DairyBW/Fig.7.png" class="img-fluid rounded z-depth-0" width="auto" height="auto" title="cv1" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" />

  </picture>

</figure>

    </div>

</div>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/DairyBW/Fig.10-480.webp" />
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/DairyBW/Fig.10-800.webp" />
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/DairyBW/Fig.10-1400.webp" />
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/DairyBW/Fig.10.png" class="img-fluid rounded z-depth-0" width="auto" height="auto" title="cv1" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" />

  </picture>

</figure>

    </div>

</div>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/DairyBW/Table2-480.webp" />
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/DairyBW/Table2-800.webp" />
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/DairyBW/Table2-1400.webp" />
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/DairyBW/Table2.png" class="img-fluid rounded z-depth-0" width="auto" height="auto" title="cv1" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" />

  </picture>

</figure>

    </div>

</div>
:ET